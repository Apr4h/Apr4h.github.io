---
title: Detecting Process Injection Part 1
tags: [process injection, Windows, memory forensics, C#, programming, DFIR, PInvoke, .NET Framework, DLL Injection]
layout: post
---

This post breaks down how to detect classic and reflective DLL injection on a live Windows host by enumerating running processes and their threads for signs of malicious code injection. My tool [GetInjectedThreads](https://github.com/Apr4h/GetInjectedThreads) is a recreation of Jared Atkinson's [Get-InjectedThread.ps1](https://gist.github.com/jaredcatkinson/23905d34537ce4b5b1818c3e6405c1d2) in C#. I'll be using code snippets from my tool throughout this post to explain the detection process and screenshots of my tool's output to show detection of malware such as meterpreter and Cobalt Strike. While my tool currently finds injected threads and outputs information useful for responders, a Part 2 of this post will take it a step further, scanning identified processes for malware and extracting useful configuration information from them!
